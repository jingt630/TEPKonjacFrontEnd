<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Folder Creation</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        h1 { color: #646cff; }
        button {
            background: #646cff;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 8px;
            margin: 10px 0;
        }
        button:hover { background: #535bf2; }
        .log {
            background: #000;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
        }
        .success { color: #4ade80; }
        .error { color: #ff6b6b; }
        .info { color: #60a5fa; }
    </style>
</head>
<body>
    <h1>üêõ Debug Folder Creation</h1>
    <button onclick="debugCreateFolder()">üß™ Test Create Folder (Detailed)</button>
    <div id="log" class="log"></div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'info';
            logDiv.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            console.log(message);
        }

        async function debugCreateFolder() {
            document.getElementById('log').innerHTML = '';
            
            log('üöÄ Starting detailed debug...', 'info');
            log('================================', 'info');
            
            const url = 'http://localhost:8000/api/MediaManagement/createFolder';
            const folderData = {
                filePath: '/',
                name: `Debug Test ${Date.now()}`
            };
            
            log(`üìç URL: ${url}`, 'info');
            log(`üì¶ Request Data: ${JSON.stringify(folderData, null, 2)}`, 'info');
            log('', 'info');
            
            try {
                log('‚è≥ Sending request...', 'info');
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(folderData)
                });
                
                log(`üìä Response Status: ${response.status} ${response.statusText}`, 
                    response.ok ? 'success' : 'error');
                log(`üìã Response Headers:`, 'info');
                for (let [key, value] of response.headers.entries()) {
                    log(`   ${key}: ${value}`, 'info');
                }
                log('', 'info');
                
                // Try to get response body
                const contentType = response.headers.get('content-type');
                log(`üìÑ Content-Type: ${contentType}`, 'info');
                
                let responseData;
                if (contentType && contentType.includes('application/json')) {
                    responseData = await response.json();
                    log(`üìù Response Body (JSON):`, response.ok ? 'success' : 'error');
                    log(JSON.stringify(responseData, null, 2), response.ok ? 'success' : 'error');
                } else {
                    responseData = await response.text();
                    log(`üìù Response Body (Text):`, 'error');
                    log(responseData, 'error');
                }
                
                log('', 'info');
                if (response.ok) {
                    log('‚úÖ SUCCESS! Folder created successfully!', 'success');
                } else {
                    log('‚ùå FAILED! See error details above', 'error');
                    log('', 'info');
                    log('üí° Possible issues:', 'info');
                    log('   1. Backend expects different parameters', 'info');
                    log('   2. Missing user authentication', 'info');
                    log('   3. Database connection issue', 'info');
                    log('   4. Validation error', 'info');
                }
                
            } catch (error) {
                log('', 'info');
                log('‚ùå NETWORK ERROR!', 'error');
                log(`Error: ${error.message}`, 'error');
                log('', 'info');
                log('üí° This usually means:', 'info');
                log('   1. Backend is not running', 'info');
                log('   2. CORS is not configured', 'info');
                log('   3. Wrong URL/port', 'info');
                log('', 'info');
                log('üîç Check your backend terminal for errors', 'info');
            }
        }
    </script>
</body>
</html>

